#include <reg932.inc>
cseg at 00h

MOV P2M1, #00h;select bidirectional mode

MAIN:
; green led
JB p2.3,CHECK_AMBER;checks to see if green LED is pressed otherwise goes to CHECK_AMBER

WAITG:; check if button is un-pressed
JNB p2.3, WAITG;holds on LED until button un-pressed

CPL P2.7;turns on the LED
ACALL DELAY; delay 1 second
CPL P2.7;LED off


CHECK_AMBER:
JB P2.2, CHECK_YELLOW; same code as MAIN but with different pins

WAITA:
JNB p2.2, WAITA

CPL P2.6; Turns on
ACALL DELAY
CPL P2.6; Turns off


CHECK_YELLOW:
JB P2.1, CHECK_RED; same code as MAIN but with different pins

WAITY:
JNB p2.1, WAITY

CPL P2.5; Turns on
ACALL DELAY
CPL P2.5; Turns off


CHECK_RED:
JB P2.0, MAIN; same code as MAIN but with different pins

WAITR:
JNB p2.0, WAITR

CPL P2.4; Turns on
ACALL DELAY
CPL P2.4; Turns off

DELAY: ;delay for 1 second
MOV R2, #30
Loop3:
	MOV R1, #240
	Loop2:
		MOV R0, #240
		Loop1:
		DJNZ R0, (Loop1); decrements  value of the reg and then jumps to next loop

	DJNZ R1, (Loop2)
DJNZ R2, (Loop3)
RET
END

